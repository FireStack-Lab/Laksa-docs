<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Transaction | Laksa</title>
    <meta name="description" content="Zilliqa BlockChain Javascript API">
    
    
    <link rel="preload" href="/Laksa-docs/assets/css/0.styles.c94186b5.css" as="style"><link rel="preload" href="/Laksa-docs/assets/js/app.747733de.js" as="script"><link rel="preload" href="/Laksa-docs/assets/js/13.b3f67cc4.js" as="script"><link rel="prefetch" href="/Laksa-docs/assets/js/2.798e7f11.js"><link rel="prefetch" href="/Laksa-docs/assets/js/3.4ec6e003.js"><link rel="prefetch" href="/Laksa-docs/assets/js/4.f12163e9.js"><link rel="prefetch" href="/Laksa-docs/assets/js/5.bbfb23c1.js"><link rel="prefetch" href="/Laksa-docs/assets/js/6.29329703.js"><link rel="prefetch" href="/Laksa-docs/assets/js/7.16ace59a.js"><link rel="prefetch" href="/Laksa-docs/assets/js/8.5ad2b22d.js"><link rel="prefetch" href="/Laksa-docs/assets/js/9.5625b23f.js"><link rel="prefetch" href="/Laksa-docs/assets/js/10.b9e88e6c.js"><link rel="prefetch" href="/Laksa-docs/assets/js/11.0c56aa1b.js"><link rel="prefetch" href="/Laksa-docs/assets/js/12.eb9a70ac.js"><link rel="prefetch" href="/Laksa-docs/assets/js/14.fb129579.js"><link rel="prefetch" href="/Laksa-docs/assets/js/15.95d44816.js"><link rel="prefetch" href="/Laksa-docs/assets/js/16.387e06d2.js"><link rel="prefetch" href="/Laksa-docs/assets/js/17.8c994772.js"><link rel="prefetch" href="/Laksa-docs/assets/js/18.ab1e666f.js"><link rel="prefetch" href="/Laksa-docs/assets/js/19.6d6adb4b.js"><link rel="prefetch" href="/Laksa-docs/assets/js/20.2d814266.js"><link rel="prefetch" href="/Laksa-docs/assets/js/21.6c2c7072.js"><link rel="prefetch" href="/Laksa-docs/assets/js/22.22cf1045.js"><link rel="prefetch" href="/Laksa-docs/assets/js/vendors~docsearch.be19280e.js">
    <link rel="stylesheet" href="/Laksa-docs/assets/css/0.styles.c94186b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Laksa-docs/" class="home-link router-link-active"><!----> <span class="site-name">Laksa</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Laksa-docs/" class="nav-link">Intro</a></div><div class="nav-item"><a href="/Laksa-docs/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="/Laksa-docs/api/" class="nav-link">API Reference</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Laksa-docs/guide/Transaction.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/Laksa-docs/zh/guide/Transaction.html" class="nav-link">简体中文</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Laksa-docs/" class="nav-link">Intro</a></div><div class="nav-item"><a href="/Laksa-docs/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="/Laksa-docs/api/" class="nav-link">API Reference</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Laksa-docs/guide/Transaction.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/Laksa-docs/zh/guide/Transaction.html" class="nav-link">简体中文</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/Laksa-docs/guide/" class="sidebar-link">Getting Started</a></li><li><a href="/Laksa-docs/guide/QuickTutorial.html" class="sidebar-link">Quick Tutorial</a></li><li><a href="/Laksa-docs/guide/Transaction.html" class="active sidebar-link">Transaction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#what-is-transaction" class="sidebar-link">What is Transaction?</a></li><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#transaction-logic-to-remember" class="sidebar-link">Transaction logic to remember</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#_1-construct-a-transaction-object" class="sidebar-link">1. Construct a transaction object</a></li><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#_2-sign-the-transaction-with-account" class="sidebar-link">2. Sign the transaction with account</a></li><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#_3-send-the-signed-transaction-to-blockchain" class="sidebar-link">3. Send the signed transaction to Blockchain</a></li><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#_4-to-confirm-a-transaction" class="sidebar-link">4. To confirm a transaction</a></li><li class="sidebar-sub-header"><a href="/Laksa-docs/guide/Transaction.html#_5-sum-it-up" class="sidebar-link">5. Sum it up</a></li></ul></li></ul></li></ul> </div> <div class="page"> <div class="content"><h1 id="transaction"><a href="#transaction" aria-hidden="true" class="header-anchor">#</a> Transaction</h1> <h2 id="what-is-transaction"><a href="#what-is-transaction" aria-hidden="true" class="header-anchor">#</a> What is Transaction?</h2> <p>Transaction is the core logic to every blockchain.</p> <p>Transaction happens when:</p> <ol><li>Transfer token from address to address.</li> <li>Sending messages from address to address.</li> <li>Deploy or Call a smart contract.</li></ol> <p>Transaction <strong>DOES NOT</strong> happen when:</p> <ol><li>Accounts creating or importing</li> <li>Make RPC queries to get blockchain infomation</li></ol> <h2 id="transaction-logic-to-remember"><a href="#transaction-logic-to-remember" aria-hidden="true" class="header-anchor">#</a> Transaction logic to remember</h2> <p>The Transasctin logic on-chain is complex, and somehow different between blockchains.</p> <p>However it comes to Client-Side development, it's almost the same.</p> <p>So we had better to keep that in mind.</p> <p>To make it easier to understand, we take <code>Transfer Token</code> process to decode the logic.</p> <h3 id="_1-construct-a-transaction-object"><a href="#_1-construct-a-transaction-object" aria-hidden="true" class="header-anchor">#</a> 1. Construct a transaction object</h3> <p>Say Alice wants to send some Token to Bob, Alice has to know the information as follows:</p> <ol><li><code>toAddr</code>, that is Bob's Address.</li> <li><code>amount</code>, that is the amount Bob want to receive,we assume she wants to send 1000 token</li> <li><code>gasLimit</code>, that is the maximum gas fee the blockchain will consume, according to Zilliqa, gasLimit has to be Long</li> <li><code>gasPrice</code>, that is the gas per transaction willing to pay for the blockchain miners,according to Zilliqa, minimum gasPrice has to be 100, and only accept type with BN</li> <li><code>version</code>, that is the version number of protocal, we set it to zero by default</li></ol> <p>then you can use the <code>laksa.transactions</code> to construct a new transaction object initially.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/*
    we set toAddr to address of Bob
    we set amount to expected ammount with 1000
    we set gasPrice to 100 by default
    we set gasLimit to 1000 for example
    we set version to 0 by default
*/</span>

<span class="token keyword">const</span> transaction <span class="token operator">=</span> laksa<span class="token punctuation">.</span>transactions<span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  toAddr<span class="token punctuation">:</span> <span class="token string">'9bfec715a6bd658fcb62b0f8cc9bfa2ade71434a'</span><span class="token punctuation">,</span>
  amount<span class="token punctuation">:</span> laksa<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">toBN</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  gasPrice<span class="token punctuation">:</span> laksa<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">toBN</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  gasLimit<span class="token punctuation">:</span> laska<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Long<span class="token punctuation">.</span><span class="token function">fromNumber</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  version<span class="token punctuation">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_2-sign-the-transaction-with-account"><a href="#_2-sign-the-transaction-with-account" aria-hidden="true" class="header-anchor">#</a> 2. Sign the transaction with account</h3> <p>When the Transaction Object is created, you can't send to blockchain immediately.</p> <p>Like you pay someone with checks, you have to sign your name.</p> <p>Every Transaction needs signature, you have to use account to sign it.</p> <p>First you make sure you have account, imported to Wallet or Account.</p> <p>Then you can use <code>signTransaction</code> method to sign the transaction.</p> <p>And remember, the signTransaction method returns a <code>Promise</code>, because we update the account balance and nonce interally,</p> <p>And if your account is encrypted, you have to provide a password string.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// we use wallet to import a privateKey,</span>
<span class="token comment">// that the account object will contain all the featrues to access the blockchain</span>

<span class="token keyword">const</span> myAccount <span class="token operator">=</span> laksa<span class="token punctuation">.</span>wallet<span class="token punctuation">.</span><span class="token function">importAccountFromPrivateKey</span><span class="token punctuation">(</span><span class="token constant">YOUR_KEY</span><span class="token punctuation">)</span>

<span class="token comment">// you can use `new laksa.Modules.Account()` to construct a account,</span>
<span class="token comment">// but you have to make Messenger and Provider constructed</span>

myAccount<span class="token punctuation">.</span><span class="token function">signTransaction</span><span class="token punctuation">(</span>transaction<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>signed <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>signed<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// if your account is encrypted, you pass the password to the second argument.</span>
<span class="token comment">// myAccount.signTransaction(transaction,password)</span>
<span class="token comment">// after signed process, you can see the result with a signature</span>
</code></pre></div><h3 id="_3-send-the-signed-transaction-to-blockchain"><a href="#_3-send-the-signed-transaction-to-blockchain" aria-hidden="true" class="header-anchor">#</a> 3. Send the signed transaction to Blockchain</h3> <p>After you have signed the transaction, you send it to blockchain.</p> <p>There are at least 2 ways to send a Transaction.</p> <p>Use <code>Transaction.sendTransaction()</code> if you continue with the Transaction Object.
Use <code>laksa.zil.createTransaction(SignedTransaction)</code> if you use the SignedTransaction as the param to send.</p> <p>But these two different method has different outcome.
For the first one, it will returns <code>Transaction</code> object itself, and it may continue with <code>then</code> to make further executions.
For the second one, it will only returns RPC Response, you have to use other functions to make further executions.</p> <p>We continue with Transaction Object as our tutorial.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>myAccount
  <span class="token punctuation">.</span><span class="token function">signTransaction</span><span class="token punctuation">(</span>transaction<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>signed <span class="token operator">=&gt;</span> signed<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>sent <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sent<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">/**
 * you should be able to see return object with
  {transaction:&lt;Object:Transaction&gt;,response:Response}
 */</span>
</code></pre></div><h3 id="_4-to-confirm-a-transaction"><a href="#_4-to-confirm-a-transaction" aria-hidden="true" class="header-anchor">#</a> 4. To confirm a transaction</h3> <p>After the transaction is sent, <code>laksa</code> will make the RPC call to Zilliqa's blockchain.</p> <p>The RPC call will returns some response, if not error, it will return <code>TranID</code> as your transaction reference ID.</p> <p>However, not every transaction will be accepted by the Blockchain, If:</p> <ol><li>Your transaction paramater is not correct, like the gasLimit/gasPrice did not reach the blockchain rules.</li> <li>Your account balance is not enough to transfer, <code>laksa</code> won't check for you, for App developer, you'd better check it manually.</li> <li><code>Traffic Jam</code> of the blockchain, or some unknown errors happens.(Real life is complex)</li></ol> <p>So we have to confirm it after we sent a transaction</p> <p>In the previous section, we received an object like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
   transaction<span class="token punctuation">:</span><span class="token operator">&lt;</span>Object<span class="token punctuation">:</span>Transaction<span class="token operator">&gt;</span><span class="token punctuation">,</span>
   response<span class="token punctuation">:</span><span class="token operator">&lt;</span>Response<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can see <code>transaction</code> is the Transaction Object it self, we can proceed it with the <code>response</code></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * the transaction.confirm received TranID as its params
 * then it will call the RPC methods to track the transaction from time to time
 */</span>

myAccount
  <span class="token punctuation">.</span><span class="token function">signTransaction</span><span class="token punctuation">(</span>transaction<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>signed <span class="token operator">=&gt;</span> signed<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>res <span class="token operator">=&gt;</span> res<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>response<span class="token punctuation">.</span>TranID<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span>

<span class="token comment">/**
 * you will get Transaction Object back with receipt
 */</span>
</code></pre></div><p>If the Transaction is accepted by the blockchain finally, you will get the <code>Transaction.receipt</code> with <code>{cumulative_gas:string,success:boolean}</code></p> <p>The <code>cumulative_gas</code> indicates the gas fee that consumed by blockchain.
The <code>success</code> with boolean indicates the state of transaction is successful or not</p> <p>And if the Transaction is confirmed by <code>confirm</code> method, it will also changed the <code>status</code> of Transaction Object.</p> <p>With <code>REJECTED</code> or <code>SUCCESS</code>, here <code>REJECTED</code> means <code>success:false</code>, and <code>SUCCESS</code> means <code>success:true</code> apparently.</p> <p>But the Transaction is not accepted, the status will be remain <code>SENT</code></p> <h3 id="_5-sum-it-up"><a href="#_5-sum-it-up" aria-hidden="true" class="header-anchor">#</a> 5. Sum it up</h3> <p>The Transaction process is not hard to understand. It is always follows:</p> <ol><li><p><strong>Construct</strong></p> <p>use <code>laksa.transactions.new</code> to initialize</p> <p>Transaction Status:Initialized</p></li> <li><p><strong>Sign</strong></p> <p>use <code>account.signTransaction</code> to sign, signing signer account and password if necessary</p> <p>Transaction Status:Signed</p></li> <li><p><strong>Send</strong></p> <p>use <code>Transaction.send</code> to send, it will return {transaction:Transaction,response:Response}</p> <p>Transaction Status:Sent</p></li> <li><p><strong>Confirm</strong></p> <p>use <code>Transaction.confirm</code> to confirm, send the <code>TranID</code> as paremater, if it is appeared on the Blockchain, the receipt will return</p> <p>Transaction Status:Success / Rejected</p></li></ol></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Laksa-docs/guide/QuickTutorial.html" class="prev">
          Quick Tutorial
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/Laksa-docs/assets/js/13.b3f67cc4.js" defer></script><script src="/Laksa-docs/assets/js/app.747733de.js" defer></script>
  </body>
</html>
