(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{179:function(t,a,n){"use strict";n.r(a);var s=n(0),e=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"transaction"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#transaction","aria-hidden":"true"}},[t._v("#")]),t._v(" Transaction")]),t._v(" "),n("h2",{attrs:{id:"what-is-transaction"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#what-is-transaction","aria-hidden":"true"}},[t._v("#")]),t._v(" What is Transaction?")]),t._v(" "),n("p",[t._v("Transaction is the core logic to every blockchain.")]),t._v(" "),n("p",[t._v("Transaction happens when:")]),t._v(" "),n("ol",[n("li",[t._v("Transfer token from address to address.")]),t._v(" "),n("li",[t._v("Sending messages from address to address.")]),t._v(" "),n("li",[t._v("Deploy or Call a smart contract.")])]),t._v(" "),n("p",[t._v("Transaction "),n("strong",[t._v("DOES NOT")]),t._v(" happen when:")]),t._v(" "),n("ol",[n("li",[t._v("Accounts creating or importing")]),t._v(" "),n("li",[t._v("Make RPC queries to get blockchain infomation")])]),t._v(" "),n("h2",{attrs:{id:"transaction-logic-to-remember"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#transaction-logic-to-remember","aria-hidden":"true"}},[t._v("#")]),t._v(" Transaction logic to remember")]),t._v(" "),n("p",[t._v("The Transasctin logic on-chain is complex, and somehow different between blockchains.")]),t._v(" "),n("p",[t._v("However it comes to Client-Side development, it's almost the same.")]),t._v(" "),n("p",[t._v("So we had better to keep that in mind.")]),t._v(" "),n("p",[t._v("To make it easier to understand, we take "),n("code",[t._v("Transfer Token")]),t._v(" process to decode the logic.")]),t._v(" "),n("h3",{attrs:{id:"_1-construct-a-transaction-object"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-construct-a-transaction-object","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. Construct a transaction object")]),t._v(" "),n("p",[t._v("Say Alice wants to send some Token to Bob, Alice has to know the information as follows:")]),t._v(" "),n("ol",[n("li",[n("code",[t._v("toAddr")]),t._v(", that is Bob's Address.")]),t._v(" "),n("li",[n("code",[t._v("amount")]),t._v(", that is the amount Bob want to receive,we assume she wants to send 1000 token")]),t._v(" "),n("li",[n("code",[t._v("gasLimit")]),t._v(", that is the maximum gas fee the blockchain will consume, according to Zilliqa, gasLimit has to be Long")]),t._v(" "),n("li",[n("code",[t._v("gasPrice")]),t._v(", that is the gas per transaction willing to pay for the blockchain miners,according to Zilliqa, minimum gasPrice has to be 100, and only accept type with BN")]),t._v(" "),n("li",[n("code",[t._v("version")]),t._v(", that is the version number of protocal, we set it to zero by default")])]),t._v(" "),n("p",[t._v("then you can use the "),n("code",[t._v("laksa.transactions")]),t._v(" to construct a new transaction object initially.")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("/*\n    we set toAddr to address of Bob\n    we set amount to expected ammount with 1000\n    we set gasPrice to 100 by default\n    we set gasLimit to 1000 for example\n    we set version to 0 by default\n*/")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" transaction "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" laksa"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transactions"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token keyword"}},[t._v("new")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  toAddr"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v("'9bfec715a6bd658fcb62b0f8cc9bfa2ade71434a'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  amount"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" laksa"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("toBN")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1000")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  gasPrice"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" laksa"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("toBN")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("100")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  gasLimit"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" laska"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Long"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("fromNumber")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1000")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  version"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h3",{attrs:{id:"_2-sign-the-transaction-with-account"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-sign-the-transaction-with-account","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. Sign the transaction with account")]),t._v(" "),n("p",[t._v("When the Transaction Object is created, you can't send to blockchain immediately.")]),t._v(" "),n("p",[t._v("Like you pay someone with checks, you have to sign your name.")]),t._v(" "),n("p",[t._v("Every Transaction needs signature, you have to use account to sign it.")]),t._v(" "),n("p",[t._v("First you make sure you have account, imported to Wallet or Account.")]),t._v(" "),n("p",[t._v("Then you can use "),n("code",[t._v("signTransaction")]),t._v(" method to sign the transaction.")]),t._v(" "),n("p",[t._v("And remember, the signTransaction method returns a "),n("code",[t._v("Promise")]),t._v(", because we update the account balance and nonce interally,")]),t._v(" "),n("p",[t._v("And if your account is encrypted, you have to provide a password string.")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("// we use wallet to import a privateKey,")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("// that the account object will contain all the featrues to access the blockchain")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" myAccount "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" laksa"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("wallet"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("importAccountFromPrivateKey")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token constant"}},[t._v("YOUR_KEY")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("// you can use `new laksa.Modules.Account()` to construct a account,")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("// but you have to make Messenger and Provider constructed")]),t._v("\n\nmyAccount"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("signTransaction")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("transaction"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("then")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signed "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signed"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("// if your account is encrypted, you pass the password to the second argument.")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("// myAccount.signTransaction(transaction,password)")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("// after signed process, you can see the result with a signature")]),t._v("\n")])])]),n("h3",{attrs:{id:"_3-send-the-signed-transaction-to-blockchain"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-send-the-signed-transaction-to-blockchain","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. Send the signed transaction to Blockchain")]),t._v(" "),n("p",[t._v("After you have signed the transaction, you send it to blockchain.")]),t._v(" "),n("p",[t._v("There are at least 2 ways to send a Transaction.")]),t._v(" "),n("p",[t._v("Use "),n("code",[t._v("Transaction.sendTransaction()")]),t._v(" if you continue with the Transaction Object.\nUse "),n("code",[t._v("laksa.zil.createTransaction(SignedTransaction)")]),t._v(" if you use the SignedTransaction as the param to send.")]),t._v(" "),n("p",[t._v("But these two different method has different outcome.\nFor the first one, it will returns "),n("code",[t._v("Transaction")]),t._v(" object itself, and it may continue with "),n("code",[t._v("then")]),t._v(" to make further executions.\nFor the second one, it will only returns RPC Response, you have to use other functions to make further executions.")]),t._v(" "),n("p",[t._v("We continue with Transaction Object as our tutorial.")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("myAccount\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("signTransaction")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("transaction"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("then")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signed "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" signed"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("sendTransaction")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("then")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sent "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("log")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sent"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("/**\n * you should be able to see return object with\n  {transaction:<Object:Transaction>,response:Response}\n */")]),t._v("\n")])])]),n("h3",{attrs:{id:"_4-to-confirm-a-transaction"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-to-confirm-a-transaction","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. To confirm a transaction")]),t._v(" "),n("p",[t._v("After the transaction is sent, "),n("code",[t._v("laksa")]),t._v(" will make the RPC call to Zilliqa's blockchain.")]),t._v(" "),n("p",[t._v("The RPC call will returns some response, if not error, it will return "),n("code",[t._v("TranID")]),t._v(" as your transaction reference ID.")]),t._v(" "),n("p",[t._v("However, not every transaction will be accepted by the Blockchain, If:")]),t._v(" "),n("ol",[n("li",[t._v("Your transaction paramater is not correct, like the gasLimit/gasPrice did not reach the blockchain rules.")]),t._v(" "),n("li",[t._v("Your account balance is not enough to transfer, "),n("code",[t._v("laksa")]),t._v(" won't check for you, for App developer, you'd better check it manually.")]),t._v(" "),n("li",[n("code",[t._v("Traffic Jam")]),t._v(" of the blockchain, or some unknown errors happens.(Real life is complex)")])]),t._v(" "),n("p",[t._v("So we have to confirm it after we sent a transaction")]),t._v(" "),n("p",[t._v("In the previous section, we received an object like this:")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   transaction"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("Object"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Transaction"),n("span",{attrs:{class:"token operator"}},[t._v(">")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   response"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token operator"}},[t._v("<")]),t._v("Response"),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),n("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("You can see "),n("code",[t._v("transaction")]),t._v(" is the Transaction Object it self, we can proceed it with the "),n("code",[t._v("response")])]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("/**\n * the transaction.confirm received TranID as its params\n * then it will call the RPC methods to track the transaction from time to time\n */")]),t._v("\n\nmyAccount\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("signTransaction")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("transaction"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("then")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("signed "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" signed"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("sendTransaction")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("then")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res "),n("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" res"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transaction"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("confirm")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("TranID"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token function"}},[t._v("then")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("console"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("/**\n * you will get Transaction Object back with receipt\n */")]),t._v("\n")])])]),n("p",[t._v("If the Transaction is accepted by the blockchain finally, you will get the "),n("code",[t._v("Transaction.receipt")]),t._v(" with "),n("code",[t._v("{cumulative_gas:string,success:boolean}")])]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("cumulative_gas")]),t._v(" indicates the gas fee that consumed by blockchain.\nThe "),n("code",[t._v("success")]),t._v(" with boolean indicates the state of transaction is successful or not")]),t._v(" "),n("p",[t._v("And if the Transaction is confirmed by "),n("code",[t._v("confirm")]),t._v(" method, it will also changed the "),n("code",[t._v("status")]),t._v(" of Transaction Object.")]),t._v(" "),n("p",[t._v("With "),n("code",[t._v("REJECTED")]),t._v(" or "),n("code",[t._v("SUCCESS")]),t._v(", here "),n("code",[t._v("REJECTED")]),t._v(" means "),n("code",[t._v("success:false")]),t._v(", and "),n("code",[t._v("SUCCESS")]),t._v(" means "),n("code",[t._v("success:true")]),t._v(" apparently.")]),t._v(" "),n("p",[t._v("But the Transaction is not accepted, the status will be remain "),n("code",[t._v("SENT")])])])}],!1,null,null,null);e.options.__file="Transaction.md";a.default=e.exports}}]);